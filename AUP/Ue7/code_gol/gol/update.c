#include "gol.h"



/*
 Nicht schummeln!
 Alles was Sie wissen m√ºssen steht in gol.c und gol.h
 
 Viele Erfolg
*/











































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































int neighborsCount(const struct panelParams par, enum field arr[par.maxX][par.maxY][par.maxAge], int posX, int posY);
int xInLoop(const struct panelParams par, int posX);
int yInLoop(const struct panelParams par, int posY);


/*
 Update the given panel (one round)
 Changes the given panel!
 Returns the part that should be active after the update
 par : parameter of the panel
 arr : the given panel
*/
int update(const struct panelParams par, enum field arr[par.maxX][par.maxY][par.maxAge]){
	int notActive;
	(par.active==0) ? (notActive=1) : (notActive=0) ;

	for(int i=0;i<par.maxX;i++){
		for(int j=0;j<par.maxY;j++){
			int neighbors = neighborsCount(par, arr, i, j);
			if(arr[i][j][par.active] == dead){
				(neighbors == 3) ? (arr[i][j][notActive] = alive) : (arr[i][j][notActive] = dead);
			}
			else{
				if(neighbors<2){
					arr[i][j][notActive] = dead;
				}
				if(neighbors==2 || neighbors==3){
					arr[i][j][notActive] = alive;
				}
				if(neighbors>3){
					arr[i][j][notActive] = dead;
				}
			}
		}
	}
	
	return notActive;
}


/*
 Calculates the number of alive neighbors of a given index
 Returns the number of neighbors
 par : parameter of the panel
 arr : the given panel
 posX : x coordinate oft the index
 posY : y coordinate oft the index
*/
int neighborsCount(const struct panelParams par, enum field arr[par.maxX][par.maxY][par.maxAge], int posX, int posY){
	int count = 0;
	if(arr[posX][posY][par.active] == alive){
		count --;
	}
	for(int i=-1; i<=1; i++){
		for(int j=-1; j<=1; j++){
			if(arr[xInLoop(par, posX+i)][yInLoop(par, posY+j)][par.active] == alive){
				count++;
			}
		}
	}
	return count;
}


/*
 Corrects the given coordinate by respecting the allowed indexes
 Returnes the corrected x coordinate oft the index
 par : parameter of the panel
 posX : x coordinate oft the index
*/
int xInLoop(const struct panelParams par, int posX){
	while(posX>=par.maxX){
		posX = posX - par.maxX;
	}
	while(posX<0){
		posX = posX + par.maxX;
	}
	return posX;
}


/*
 Corrects the given coordinate by respecting the allowed indexes
 Returnes the corrected y coordinate oft the index
 par : parameter of the panel
 posX : ygol coordinate oft the index
*/int yInLoop(const struct panelParams par, int posY){
	while(posY>=par.maxY){
		posY = posY - par.maxY;
	}
	while(posY<0){
		posY = posY + par.maxY;
	}
	return posY;
}
